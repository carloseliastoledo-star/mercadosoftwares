datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
  directUrl = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

enum AdminRole {
  admin
  editor
}

model Produto {
  id        String    @id @default(uuid())
  nome      String
  slug      String    @unique
  descricao String?   @db.Text
  preco     Float
  ativo     Boolean   @default(true)
  imagem    String?   // ðŸ‘ˆ NOVO CAMPO
  googleAdsConversionLabel    String?
  googleAdsConversionValue    Float?
  googleAdsConversionCurrency String?
  tutorialTitulo    String?
  tutorialSubtitulo String?
  tutorialConteudo  String?   @db.Text
  criadoEm  DateTime  @default(now()) @db.DateTime(0)
  licencas  Licenca[]
  orders    Order[]
}


model Licenca {
  id          String   @id @default(uuid())
  chave       String
  status      String
  produtoId   String
  produto     Produto  @relation(fields: [produtoId], references: [id])
  customerId  String?
  customer    Customer? @relation(fields: [customerId], references: [id])
  orderId     String?
  order       Order?    @relation(fields: [orderId], references: [id])
  criadoEm    DateTime @default(now()) @db.DateTime(0)
}

model Customer {
  id        String   @id @default(uuid())
  email     String   @unique
  passwordHash String?
  nome      String?
  whatsapp  String?
  cpf       String?
  criadoEm  DateTime @default(now()) @db.DateTime(0)
  orders    Order[]
  licencas  Licenca[]
}

model Order {
  id                  String   @id @default(uuid())
  numero              Int      @unique @default(autoincrement())
  status              String
  produtoId            String
  produto              Produto  @relation(fields: [produtoId], references: [id])
  customerId           String
  customer             Customer @relation(fields: [customerId], references: [id])
  mercadoPagoPaymentId String?  @unique
  criadoEm             DateTime @default(now()) @db.DateTime(0)
  pagoEm               DateTime? @db.DateTime(0)
  emailEnviadoEm       DateTime? @db.DateTime(0)
  licencas             Licenca[]
}

model Pagina {
  id          String   @id @default(uuid())
  titulo      String
  slug        String   @unique
  conteudo    String?  @db.Text
  publicado   Boolean  @default(false)
  criadoEm    DateTime @default(now()) @db.DateTime(0)
  atualizadoEm DateTime @updatedAt @db.DateTime(0)
}

model AdminUser {
  id           String    @id @default(uuid())
  email        String    @unique
  passwordHash String
  role         AdminRole @default(editor)
  createdAt    DateTime  @default(now()) @db.DateTime(0)
}

model SiteSettings {
  id                     String   @id @default(uuid())
  googleAdsConversionId  String?
  googleAdsConversionLabel String?
  createdAt              DateTime @default(now()) @db.DateTime(0)
  updatedAt              DateTime @updatedAt @db.DateTime(0)
}
