datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
  directUrl = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

enum AdminRole {
  admin
  editor
}

model Produto {
  id        String    @id @default(uuid())
  nome      String
  slug      String    @unique
  descricao String?
  preco     Float
  imagem    String?   // ðŸ‘ˆ NOVO CAMPO
  tutorialTitulo    String?
  tutorialSubtitulo String?
  tutorialConteudo  String?   @db.Text
  criadoEm  DateTime  @default(now()) @db.DateTime(0)
  licencas  Licenca[]
  orders    Order[]
}


model Licenca {
  id          String   @id @default(uuid())
  chave       String
  status      String
  produtoId   String
  produto     Produto  @relation(fields: [produtoId], references: [id])
  customerId  String?
  customer    Customer? @relation(fields: [customerId], references: [id])
  orderId     String?
  order       Order?    @relation(fields: [orderId], references: [id])
  criadoEm    DateTime @default(now()) @db.DateTime(0)
}

model Customer {
  id        String   @id @default(uuid())
  email     String   @unique
  criadoEm  DateTime @default(now()) @db.DateTime(0)
  orders    Order[]
  licencas  Licenca[]
}

model Order {
  id                  String   @id @default(uuid())
  status              String
  produtoId            String
  produto              Produto  @relation(fields: [produtoId], references: [id])
  customerId           String
  customer             Customer @relation(fields: [customerId], references: [id])
  mercadoPagoPaymentId String?  @unique
  criadoEm             DateTime @default(now()) @db.DateTime(0)
  pagoEm               DateTime? @db.DateTime(0)
  licencas             Licenca[]
}

model AdminUser {
  id           String    @id @default(uuid())
  email        String    @unique
  passwordHash String
  role         AdminRole @default(editor)
  createdAt    DateTime  @default(now()) @db.DateTime(0)
}
